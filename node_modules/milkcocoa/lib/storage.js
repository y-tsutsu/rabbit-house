function encode(r){for(var e=[],o=0;o<r.length;o++){var t=r.charCodeAt(o)^xorkey;e.push(t.toString(36))}return e.join(",")}function decode(r){var e=r.split(","),o="";return e.forEach(function(r){o+=String.fromCharCode(parseInt(r,36)^xorkey)}),o}var myconsole=require("./logger"),xorkey=80,Storage=null;if("browser"!==process.title){var fs=require("fs"),path_module=require("path");Storage=function(r){return{set:function(e,o){var t=path_module.join(r,e);fs.writeFileSync(t,encode(JSON.stringify(o)))},get:function(e){var o=path_module.join(r,e);if(!fs.existsSync(o))return null;var t=fs.readFileSync(o),n=null;try{n=JSON.parse(decode(String(t)))}catch(a){myconsole.error("parse error",a)}return n}}}}else Storage=function(){return{set:function(r,e){window.localStorage&&window.localStorage.setItem(r,encode(JSON.stringify(e)))},get:function(r){if(!window.localStorage)return null;var e=window.localStorage.getItem(r),o=null;try{o=JSON.parse(decode(e))}catch(t){myconsole.error("parse error",t)}return o}}};module.exports=Storage;