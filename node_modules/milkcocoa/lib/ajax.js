function request(e,t,r,n,o,s,u,i){function a(e){if(i){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){i(null,JSON.parse(t))})}}var p=t?https:http;u["Content-Type"]="application/x-www-form-urlencoded";var d={hostname:r,port:n||(t?443:80),path:o,method:e,headers:u};if("GET"==e){var l=querystring.stringify(s);d.path+="?"+l,p.get(d,a).on("error",function(e){i(e)})}else{var q=p.request(d,a);q.setTimeout(5e3),q.on("timeout",function(){i&&i(new Error("timed out"),null),q.abort()}),q.on("error",function(e){i&&i(e,null)});var l=querystring.stringify(s);q.write(l),q.end()}}function requestBrowser(e,t,r,n,o,s,u,i){var a=querystring.stringify(s),p=(t?"https://":"http://")+r+":"+n+o;"GET"==e&&(p+="?"+a);var d=createCORSRequest(e,p);d.withCredentials=!0,d.onload=function(){decoded="";try{var e=JSON.parse(d.responseText);i(null,e)}catch(t){i(null,JSON.parse(d.responseText))}},d.onerror=function(){i(d.statusText||"unknown error")},d.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(header_key in u)d.setRequestHeader(header_key,u[header_key]);d.send(a)}function createCORSRequest(e,t){var r=new XMLHttpRequest;return"withCredentials"in r?r.open(e,t,!0):"undefined"!=typeof XDomainRequest?(r=new XDomainRequest,r.open(e,t)):r=null,r}var http=require("http"),https=require("https"),querystring=require("querystring");"browser"!==process.title?module.exports={request:request}:module.exports={request:requestBrowser};